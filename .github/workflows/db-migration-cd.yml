name: DB_MIGRATION_CD

on:
  workflow_call:
    inputs:
      userdb:
        type: string
        required: true
      reportdb:
        type: string
        required: true
      scope3db:
        type: string
        required: true
    secrets:
      SLACK_WEBHOOK_URL:
        required: true
      USER_DB_STRING_DEV:
        required: true
      USER_DB_STRING_STG:
        required: true
      USER_DB_STRING_PRD:
        required: true
      BASTION_SSHKEY_DEV:
        required: true
      BASTION_SSHKEY_STG:
        required: true
      BASTION_SSHKEY_PRD:
        required: true

jobs:
  user-db-migration:
    needs: changes
    if: ${{ github.event.inputs.user_db == 'true' }}
    uses: ./.github/workflows/user-db-cd.yml
    secrets: inherit
